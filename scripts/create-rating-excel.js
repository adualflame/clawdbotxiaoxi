const XLSX = require('xlsx');

// 创建工作簿
const wb = XLSX.utils.book_new();

// ========== Sheet 1: 代币总览 ==========
const overviewData = [
  ['代币综合评估表 v1.0', '', '', '', '', '', '', '', '', '', '更新时间:', new Date().toLocaleString('zh-CN')],
  [],
  ['代币', '赛道', '当前价', '市值(亿)', 'FDV(亿)', 'MC/FDV', '总评分', '评级', '激进抄底', '标准抄底', '保守抄底', '备注'],
  ['JUP', 'DeFi/聚合器', 0.14, 4.5, 10, '45%', 72, 'B', 0.12, 0.11, 0.10, '2/28解锁2.53亿枚'],
  ['ONDO', 'RWA', 0.25, 12, 25, '48%', 70, 'B', 0.22, 0.21, 0.20, '贝莱德背书'],
  ['HYPE', 'DeFi/永续', 30.77, 80, 300, '25%', 68, 'C', 25, 23, 22, '流通比例低'],
  ['ATH', 'DePIN/AI', 0.0058, 1.0, 2.5, '40%', 0, '-', '-', '-', '-', '待评估'],
  ['LINK', '预言机', 8.30, 60, 60, '100%', 65, 'C', 7.5, 7.0, 6.5, '缺乏短期催化剂'],
  ['AAVE', 'DeFi/借贷', 110, 16, 16, '100%', 63, 'C', 95, 90, 85, '稳健但弹性小'],
];

const ws1 = XLSX.utils.aoa_to_sheet(overviewData);
ws1['!cols'] = [
  {wch: 8}, {wch: 12}, {wch: 10}, {wch: 10}, {wch: 10}, {wch: 8}, 
  {wch: 8}, {wch: 6}, {wch: 10}, {wch: 10}, {wch: 10}, {wch: 20}
];
XLSX.utils.book_append_sheet(wb, ws1, '代币总览');

// ========== Sheet 2: 评分明细 ==========
const scoringData = [
  ['评分明细表', '', '', '', '', '', '', ''],
  [],
  ['代币', '基本面(25)', '估值(25)', '技术面(20)', '情绪(15)', '催化剂(15)', '总分', '评级'],
  ['JUP', 18, 16, 14, 12, 12, 72, 'B'],
  ['ONDO', 17, 15, 14, 12, 12, 70, 'B'],
  ['HYPE', 20, 12, 13, 11, 12, 68, 'C'],
  ['ATH', '-', '-', '-', '-', '-', '-', '待评估'],
  ['LINK', 18, 14, 12, 10, 11, 65, 'C'],
  ['AAVE', 19, 13, 11, 10, 10, 63, 'C'],
  [],
  ['评分标准:', '', '', '', '', '', '', ''],
  ['S级: 90-100 极度低估', '', '', '', '', '', '', ''],
  ['A级: 80-89 明显低估', '', '', '', '', '', '', ''],
  ['B级: 70-79 轻度低估', '', '', '', '', '', '', ''],
  ['C级: 60-69 合理估值', '', '', '', '', '', '', ''],
  ['D级: 50-59 轻度高估', '', '', '', '', '', '', ''],
  ['F级: <50 高风险回避', '', '', '', '', '', '', ''],
];

const ws2 = XLSX.utils.aoa_to_sheet(scoringData);
ws2['!cols'] = [
  {wch: 8}, {wch: 12}, {wch: 10}, {wch: 12}, {wch: 10}, {wch: 12}, {wch: 8}, {wch: 8}
];
XLSX.utils.book_append_sheet(wb, ws2, '评分明细');

// ========== Sheet 3: 抄底监控 ==========
const monitorData = [
  ['抄底监控表', '', '', '', '', '', '', ''],
  [],
  ['代币', '当前价', '激进线', '标准线', '保守线', '距激进', '距标准', '状态'],
  ['JUP', 0.14, 0.12, 0.11, 0.10, '-14%', '-21%', '观望'],
  ['ONDO', 0.25, 0.22, 0.21, 0.20, '-12%', '-16%', '观望'],
  ['HYPE', 30.77, 25, 23, 22, '-19%', '-25%', '观望'],
  ['ATH', 0.0058, '-', '-', '-', '-', '-', '待评估'],
  [],
  ['解锁日历:', '', '', '', '', '', '', ''],
  ['日期', '代币', '解锁量', '占流通%', '影响预估', '', '', ''],
  ['2026-02-28', 'JUP', '2.53亿', '8%', '短期利空', '', '', ''],
  ['2026-03-06', 'HYPE', '992万', '2.8%', '影响较小', '', '', ''],
  ['2026-06-13', 'ATH', 'eATH赎回', '-', '待观察', '', '', ''],
];

const ws3 = XLSX.utils.aoa_to_sheet(monitorData);
ws3['!cols'] = [
  {wch: 12}, {wch: 10}, {wch: 10}, {wch: 10}, {wch: 10}, {wch: 10}, {wch: 10}, {wch: 10}
];
XLSX.utils.book_append_sheet(wb, ws3, '抄底监控');

// ========== Sheet 4: 评分维度说明 ==========
const dimensionData = [
  ['评分维度说明', '', '', ''],
  [],
  ['一、基本面 (25分)', '', '', ''],
  ['指标', '满分', '计算方式', ''],
  ['团队背景', 3, '知名3/有经验2/匿名1', ''],
  ['融资背景', 3, '顶级VC 3/知名VC 2/普通1', ''],
  ['产品成熟度', 4, '盈利4/上线3/测试网2/概念1', ''],
  ['赛道热度', 4, '热门4/稳定3/冷门2/过气1', ''],
  ['竞争地位', 4, '龙头4/前三3/前十2/其他1', ''],
  ['协议收入', 4, '>1亿4/>1000万3/>100万2/<100万1', ''],
  ['TVL增长', 3, '月增>20%3/>10%2/>0%1/负0', ''],
  [],
  ['二、估值分析 (25分)', '', '', ''],
  ['MC/FDV比', 5, '>70%5/>50%4/>30%3/>20%2/<20%1', ''],
  ['FDV/收入比', 5, '<10倍5/<20倍4/<50倍3/<100倍2/>100倍1', ''],
  ['vs赛道龙头', 5, '<50%5/<70%4/<90%3/相当2/更高1', ''],
  ['vs历史估值', 5, '<50%5/<70%4/<90%3/相当2/更高1', ''],
  ['近3月解锁', 5, '<5%5/<10%4/<20%3/<30%2/>30%1', ''],
  [],
  ['三、技术面 (20分)', '', '', ''],
  ['距ATH跌幅', 5, '>80%5/>60%4/>40%3/>20%2/<20%1', ''],
  ['距前低位置', 5, '<10%5/<20%4/<30%3/<50%2/>50%1', ''],
  ['RSI(14)', 4, '<30得4/<40得3/<50得2/<60得1/>60得0', ''],
  ['成交量趋势', 3, '放量企稳3/缩量跌2/放量跌1', ''],
  ['支撑位', 3, '强支撑3/接近2/无明显1', ''],
  [],
  ['四、市场情绪 (15分)', '', '', ''],
  ['恐惧贪婪指数', 4, '<20得4/<40得3/<60得2/<80得1/>80得0', ''],
  ['BTC趋势', 4, '上涨4/震荡3/跌企稳2/下跌1', ''],
  ['社交提及', 4, '周增>50%4/>20%3/>0%2/下降1', ''],
  ['开发活跃度', 3, '周commit>20得3/>10得2/>0得1/无0', ''],
  [],
  ['五、催化剂 (15分)', '', '', ''],
  ['上所预期', 4, '确定4/传闻3/可能2/无1', ''],
  ['产品发布', 4, '重大4/常规2/无1', ''],
  ['路线图里程碑', 4, '重大4/一般2/无1', ''],
  ['合作扩展', 3, '重大3/一般2/无1', ''],
];

const ws4 = XLSX.utils.aoa_to_sheet(dimensionData);
ws4['!cols'] = [{wch: 15}, {wch: 8}, {wch: 35}, {wch: 10}];
XLSX.utils.book_append_sheet(wb, ws4, '评分维度说明');

// 保存文件
const filePath = 'C:\\Users\\adual\\.openclaw\\workspace\\projects\\token-rating-system\\代币综合评估表_2026-02-13.xlsx';
XLSX.writeFile(wb, filePath);
console.log('Excel 文件已创建:', filePath);
